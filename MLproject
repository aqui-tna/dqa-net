name: allenai/dqa-net
conda_env: conda_dqa-net.yaml
entry_points:
  step0_download-data-and-models:
    command: "chmod +x download.sh \n ./download.sh"
  step1_data-preprocessing:
    parameters:
      data_dir:
        type: str
        default: /home/anglil/data/dqa/shining3
      target_dir:
        type: str
        default: data/s3
      glove_path:
        type: str
        default: /home/anglil/models/glove/glove.6B.300d.txt
      min_count:
        type: float
        default: 5
      vgg_model_path:
        type: str
        default: ~/models/vgg/vgg-19.caffemodel
      vgg_proto_path:
        type: str
        default: ~/models/vgg/vgg-19.prototxt
      debug:
        type: str
        default: 'False'
      qa2hypo:
        type: str
        default: 'True'
      qa2hypo_path:
        type: str
        default: ../dqa/qa2hypo
      prepro_images:
        type: str
        default: 'True'
    command: python -m prepro.p05
  step2_trainning:
    parameters:
      model_name:
        type: str
        default: m05
      data_dir:
        type: str
        default: data/s3
      fold_path:
        type: str
        default: data/s3/folds/fold23.json
      batch_size:
        type: float
        default: 100
      init_mean:
        type: float
        default: 0
      init_std:
        type: float
        default: 0.1
      init_lr:
        type: float
        default: 0.1
      anneal_period:
        type: float
        default: 20
      anneal_ratio:
        type: float
        default: 0.5
      num_epochs:
        type: float
        default: 200
      opt:
        type: str
        default: basic
      val_num_batches:
        type: float
        default: -1
      train_num_batches:
        type: float
        default: -1
      test_num_batches:
        type: float
        default: -1
      device_type:
        type: str
        default: cpu
      num_devices:
        type: float
        default: 1
      val_period:
        type: float
        default: 5
      save_period:
        type: float
        default: 10
      config:
        type: str
        default: None
      config_ext:
        type: str
        default: .json
      hidden_size:
        type: float
        default: 50
      image_size:
        type: float
        default: 4096
      rnn_num_layers:
        type: float
        default: 1
      emb_num_layers:
        type: float
        default: 0
      keep_prob:
        type: float
        default: 1.0
      sim_func:
        type: str
        default: dot
      lstm:
        type: str
        default: basic
      forget_bias:
        type: float
        default: 2.5
      cell_clip:
        type: float
        default: 40
      rand_y:
        type: float
        default: 1.0
      mode:
        type: str
        default: dqanet
      encoder:
        type: str
        default: lstm
    command: python -m main.x05 --train
  step3_testing:
    parameters:
      model_name:
        type: str
        default: m05
      data_dir:
        type: str
        default: data/s3
      fold_path:
        type: str
        default: data/s3/folds/fold23.json
      batch_size:
        type: float
        default: 100
      init_mean:
        type: float
        default: 0
      init_std:
        type: float
        default: 0.1
      init_lr:
        type: float
        default: 0.1
      anneal_period:
        type: float
        default: 20
      anneal_ratio:
        type: float
        default: 0.5
      num_epochs:
        type: float
        default: 200
      opt:
        type: str
        default: basic
      val_num_batches:
        type: float
        default: -1
      train_num_batches:
        type: float
        default: -1
      test_num_batches:
        type: float
        default: -1
      device_type:
        type: str
        default: cpu
      num_devices:
        type: float
        default: 1
      val_period:
        type: float
        default: 5
      save_period:
        type: float
        default: 10
      config:
        type: str
        default: None
      config_ext:
        type: str
        default: .json
      hidden_size:
        type: float
        default: 50
      image_size:
        type: float
        default: 4096
      rnn_num_layers:
        type: float
        default: 1
      emb_num_layers:
        type: float
        default: 0
      keep_prob:
        type: float
        default: 1.0
      sim_func:
        type: str
        default: dot
      lstm:
        type: str
        default: basic
      forget_bias:
        type: float
        default: 2.5
      cell_clip:
        type: float
        default: 40
      rand_y:
        type: float
        default: 1.0
      mode:
        type: str
        default: dqanet
      encoder:
        type: str
        default: lstm
    command: python -m main.x05
  main:
    command: python ex_mlflow_multistep_main.py
